package controlador.comer;

import java.util.ArrayList;
import java.util.Iterator;
import modelo.*;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import util.HibernateUtil;
import util.Tupla;
import vista.comer.pantallaConsultarObra;

//
//
//  Generated by StarUML(tm) Java Add-In
//
//  @ Project : Proyecto2010_Requerimientos-iuga
//  @ File Name : GestorConsultarObra.java
//  @ Date : 14/06/2010
//  @ Author : 
//
//

public class GestorConsultarObra {
	private PedidoObra pedidoObra;
	private Planta planta;
	private ContactoResponsable contacto;
	private Telefono telefonos;
	private Integer porcentaje;
	private EmpresaCliente empresaCliente;
    private final pantallaConsultarObra pantalla;

    public GestorConsultarObra(pantallaConsultarObra aThis) {
        this.pantalla = aThis;
    }


    public void consultarObra() {

    }

    public ArrayList<Tupla> buscarObrasConfirmadas() {
        /**
         *
         * OJO! TODAVIA FALTA SABER COMO VAMOS A VER Q SEAN CONFIRMADAS!!! XD
         * POR AHORA MUESTRO TODAS LAS OBRAS.
         *
        **/
        ArrayList<Tupla> tuplas = new ArrayList<Tupla>();
        SessionFactory sf = HibernateUtil.getSessionFactory();
        Session sesion = sf.openSession();

        sesion.beginTransaction();
        Iterator iter = sesion.createQuery("from PedidoObra p order by p.nombre").iterate();
        while ( iter.hasNext() )
        {
            PedidoObra p = (PedidoObra)iter.next();
            Tupla tupla = new Tupla(p.getId(),p.getNombre());
            tuplas.add(tupla);
        }
        sesion.close();
        return tuplas;
    }

    public void seleccionObra(Tupla obra) {
        try{
            SessionFactory sf = HibernateUtil.getSessionFactory();
            Session sesion = sf.openSession();
            sesion.beginTransaction();
            this.pedidoObra = (PedidoObra)sesion.load(PedidoObra.class, obra.getId());
            sesion.getTransaction().commit();
        }
        catch(Exception e){
            System.out.println("ERROR:"+e.getMessage()+"|");
            e.printStackTrace();
        }
    }

    public void buscarDatosObra() {

    }

    public void buscarDatosPlanta() {

    }

    public void buscarContactoYTelefono() {

    }

    public void buscarEmpresaCliente() {

    }

    public void calcularPorcentajeCompletado() {

    }

    public void finCU() {

    }

    public String mostrarNombreObra(){
        return this.pedidoObra.getNombre();
    }

    public String mostrarDescripcionObra(){
        return this.pedidoObra.getDescripcion();
    }

    public String mostrarFechaRegistro(){
        return this.pedidoObra.getFechaDeRegistro().toString();
    }

    public String mostrarFechaLVP(){
        return this.pedidoObra.getFechaLimiteValidezPresupuesto().toString();
    }

    public String mostrarFechaAceptacion(){
        return this.pedidoObra.getFechaAceptacion().toString();
    }

    public String mostrarFechaLEP(){
        return this.pedidoObra.getFechaLimiteEntregaPresupuesto().toString();
    }

    public String mostrarMontoObra(){
        return String.valueOf(this.pedidoObra.getMonto());
    }
}
